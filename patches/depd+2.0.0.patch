diff --git a/node_modules/depd/index.js b/node_modules/depd/index.js
index 1bf2fcf..f27edc7 100644
--- a/node_modules/depd/index.js
+++ b/node_modules/depd/index.js
@@ -265,18 +265,26 @@ function log (message, site) {
  */
 
 function callSiteLocation (callSite) {
+  // Handle sandboxed environments (like LavaMoat) where CallSite methods may not exist
+  if (!callSite || typeof callSite.getFileName !== 'function') {
+    var site = ['<unknown>', 0, 0]
+    site.callSite = callSite
+    site.name = '<unknown>'
+    return site
+  }
+
   var file = callSite.getFileName() || '<anonymous>'
   var line = callSite.getLineNumber()
   var colm = callSite.getColumnNumber()
 
-  if (callSite.isEval()) {
+  if (typeof callSite.isEval === 'function' && callSite.isEval()) {
     file = callSite.getEvalOrigin() + ', ' + file
   }
 
   var site = [file, line, colm]
 
   site.callSite = callSite
-  site.name = callSite.getFunctionName()
+  site.name = typeof callSite.getFunctionName === 'function' ? callSite.getFunctionName() : '<unknown>'
 
   return site
 }
@@ -294,8 +302,13 @@ function defaultMessage (site) {
     funcName = '<anonymous@' + formatLocation(site) + '>'
   }
 
+  // Handle sandboxed environments where CallSite methods may not exist
+  if (!callSite || typeof callSite.getThis !== 'function') {
+    return funcName
+  }
+
   var context = callSite.getThis()
-  var typeName = context && callSite.getTypeName()
+  var typeName = context && typeof callSite.getTypeName === 'function' && callSite.getTypeName()
 
   // ignore useless type name
   if (typeName === 'Object') {
@@ -307,7 +320,7 @@ function defaultMessage (site) {
     typeName = context.name || typeName
   }
 
-  return typeName && callSite.getMethodName()
+  return typeName && typeof callSite.getMethodName === 'function' && callSite.getMethodName()
     ? typeName + '.' + funcName
     : funcName
 }
